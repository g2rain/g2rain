# g2rain 平台概述

g2rain 是一个面向企业级场景的开放平台，围绕 **认证与授权、统一前端框架、微前端壳应用与子应用生态** 构建而成。  
平台目标是：在不强绑技术栈的前提下，为“统一登录、统一入口、统一治理”的企业应用体系提供一套开箱即用的基础能力。

---

## 🎯 设计目标

- **统一认证与授权**：提供基于 SSO + JWT + DPoP 的统一认证体系，支持多应用共享登录态与权限信息。
- **统一前端壳应用**：通过主应用（Shell）承载菜单、布局、Tab、多系统聚合能力，对后端与子应用透明。
- **微前端子应用生态**：支持多个技术栈兼容的子应用以“即插即用”的方式挂载到主应用。
- **稳定的接入边界**：通过网关、Lua 签名、DPoP 等机制，将安全边界前移到网关/边缘侧。
- **可治理的开源社区**：通过清晰的治理模型与贡献流程，鼓励企业与个人共同演进平台能力。

---

## 🧩 组件一览

从逻辑上，g2rain 可以拆解为四个层次：

1. **访问入口层**
   - 浏览器 / 移动端 H5 等用户终端
   - 统一访问 `g2rain-main-shell` 主应用
2. **前端聚合层（主应用 & 子应用）**
   - `g2rain-main-shell`：主应用（Shell），提供：
     - 登录态展示与退出
     - 菜单、Tab、布局
     - 根据菜单配置动态挂载子应用
   - 子应用：
     - 基于 `g2rain-app-template` 创建，按业务域拆分
     - 通过 `qiankun` 与主应用解耦集成
3. **认证与安全层**
   - IAM 服务（如 `g2rain-iam`）提供：
     - OAuth2 / OIDC / 自研协议下的 SSO 能力
     - Token 签发、刷新与校验
   - Lua 签名服务（如 `g2rain-lua-signer`）：
     - 在 OpenResty 层生成应用级 DPoP 签名
4. **业务与数据层**
   - 现有业务系统 / 微服务集群
   - 通过 API 网关暴露统一的 HTTP 接口，对前端透明

---

## 🔑 核心能力概览

### 1. 单点登录（SSO）

- 统一登录入口，用户只需登录一次即可访问多个业务系统。
- 前端通过重定向至 SSO 认证中心，回调后获取授权码并交换 Token。
- Token 中包含：
  - 用户身份标识
  - 客户端标识与公钥
  - 授权的应用编码列表（`applicationCodes`）

### 2. Token & DPoP 安全模型

- **客户端密钥对**：
  - 前端首次访问时在浏览器本地生成（基于 WebCrypto）
  - 公钥通过 SSO 流程上送 IAM，纳入授权过程
- **DPoP（Demonstration of Proof-of-Possession）**：
  - 前端使用私钥为每个请求生成 DPoP JWT，绑定 URI + Method + Payload 哈希
  - 网关/服务端校验 DPoP，确保请求不可被简单重放
- **应用级签名**（可选）：
  - 基于 Lua + ES256，在 OpenResty 层为敏感调用生成 Application-DPoP

### 3. 微前端架构

- 主应用负责：
  - 导航与布局框架
  - 基于菜单元数据注册与加载子应用
  - 对子应用提供统一的 Token、用户信息等上下文
- 子应用负责：
  - 自己的业务路由、状态、视图
  - 通过约定的 props 接收来自主应用的 Token 与运行上下文

### 4. 开源与治理

- 所有核心模块以独立仓库形式维护，组织在 `g2rain` GitHub Organization 名下。
- 提供统一的贡献指南、行为准则与治理文档。
- 通过文档、示例与 CLI 工具降低企业接入成本。

---

## 🚀 典型使用场景

1. **统一后台门户**
   - 将现有多个后台系统整合到一个统一入口
   - 在不重写全部业务的前提下，通过微前端方式缓慢迁移与治理存量系统

2. **多租户 SaaS 平台**
   - 一个主应用 + 多个按租户 / 产品线划分的子应用
   - 共用一套 SSO 与网关能力

3. **安全要求较高的开放平台**
   - 对三方开发者开放能力时，借助 DPoP + Lua 签名防止请求重放与伪造

---

## 🧭 下一步阅读建议

如果你想进一步了解 g2rain 的内部设计与落地方式，建议按以下顺序阅读：

1. [`docs/architecture.md`](architecture.md)：总体架构、时序与模块边界
2. 各子项目 README：
   - `g2rain-main-shell`
   - `g2rain-app-template`
   - `g2rain-app-cli`
3. `docs/roadmap.md`：未来规划与演进方向（如已提供）

如果你更关注接入指南，可以直接跳到具体仓库的 Quick Start 部分。


